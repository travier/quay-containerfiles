FROM registry.fedoraproject.org/fedora:38

# Keep container image for ~3 months
LABEL quay.expires-after=12w

# Install unbound, remove unneeded packages and remove all SUID/SGID binaries
RUN dnf -y update && \
    dnf -y install unbound && \
    rm /etc/dnf/protected.d/sudo.conf && \
    dnf -y remove \
        pam \
        shadow-utils \
        sudo \
    && \
    dnf clean all && \
    find /usr \( -perm -4000 -o -perm -2000 \) -exec rm -fv {} \;

USER unbound
CMD ["/usr/sbin/unbound"]
